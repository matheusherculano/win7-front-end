"use strict";(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[545],{6545:(mt,_,s)=>{s.r(_),s.d(_,{AdministradoresModule:()=>dt});var Z=s(9132),p=s(6895),n=s(4006),w=s(4418),N=s(3706),U=s(5226),u=s.n(U),M=s(5338),x=s(257),c=s(529),h=s(2340),f=s(4004),g=s(262),F=s(263),t=s(4650);let q=(()=>{class r{constructor(e,a){this.httpCliente=e,this.authService=a,this.sheaders=new c.WM({"Content-Type":"application/json",Authorization:`Bearer ${this.authService.getToken()}`})}getHeaders(){return{headers:new c.WM({"Content-Type":"application/json",Authorization:`Bearer ${this.authService.getToken()}`})}}getAllUsuariosByAmbiente(){return this.httpCliente.get(`${h.N.baseUrlBackend}/usuario/all-in-ambiente`,this.getHeaders()).pipe((0,f.U)(a=>a),(0,g.K)(a=>{throw a.error}))}excluirUsuario(e){return this.httpCliente.get(`${h.N.baseUrlBackend}/usuario/delete/${e}`,this.getHeaders()).pipe((0,f.U)(i=>i),(0,g.K)(i=>{throw i.error}))}cadastrarOrAtualizarUsuario(e){return this.httpCliente.post(`${h.N.baseUrlBackend}/usuario`,this.buildDTO(e),this.getHeaders()).pipe((0,f.U)(i=>{}),(0,g.K)(i=>{throw i.error}))}buildDTO(e){var a={};return a.id=e.id,a.nome=e.nomeCompleto,a.login=e.login,a.email=e.email,a.whatsapp=e.whatsapp.replace(/[^0-9]+/g,""),a.senha="123456789101112"===e.password?null:e.password,a}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(c.eN),t.LFG(F.e))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var S=s(7489),d=s(7155),A=s(8739),C=s(6308),v=s(9549),I=s(4144),J=s(4859),y=s(3924),b=s(79);function E(r,o){1&r&&(t.TgZ(0,"mat-header-cell",55),t._uU(1," Nome "),t.qZA())}function k(r,o){if(1&r&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&r){const e=o.$implicit;t.xp6(1),t.hij(" ",e.nome," ")}}function Q(r,o){1&r&&(t.TgZ(0,"mat-header-cell",55),t._uU(1," Login "),t.qZA())}function B(r,o){if(1&r&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&r){const e=o.$implicit;t.xp6(1),t.hij(" ",e.login," ")}}function D(r,o){1&r&&(t.TgZ(0,"mat-header-cell",55),t._uU(1," E-mail "),t.qZA())}function Y(r,o){if(1&r&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&r){const e=o.$implicit;t.xp6(1),t.hij(" ",e.email," ")}}function V(r,o){1&r&&(t.TgZ(0,"mat-header-cell",55),t._uU(1," Whatsapp "),t.qZA())}function z(r,o){if(1&r&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&r){const e=o.$implicit;t.xp6(1),t.hij(" ",e.whatsapp," ")}}function H(r,o){1&r&&(t.TgZ(0,"mat-header-cell",55),t._uU(1," TimeStamp "),t.qZA())}function O(r,o){if(1&r&&(t.TgZ(0,"mat-cell"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&r){const e=o.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.timeStamp,"dd/MM/yyyy HH:mm")," ")}}function G(r,o){1&r&&(t.TgZ(0,"mat-header-cell",56),t._uU(1," A\xe7\xf5es "),t.qZA())}function K(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"mat-cell",56)(1,"button",57),t.NdJ("click",function(){const l=t.CHM(e).$implicit,T=t.oxw();return t.KtG(T.openAlterarModal(l))}),t.TgZ(2,"i",7),t._uU(3,"edit"),t.qZA()(),t.TgZ(4,"button",58),t.NdJ("click",function(){const l=t.CHM(e).$implicit,T=t.oxw();return t.KtG(T.excluirUsuario(l))}),t.TgZ(5,"i",7),t._uU(6,"delete_forever"),t.qZA()()()}}function P(r,o){1&r&&t._UZ(0,"mat-header-row")}function L(r,o){1&r&&t._UZ(0,"mat-row")}function j(r,o){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Campo obrigat\xf3rio "),t.qZA())}function R(r,o){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Digite um E-mail v\xe1lido "),t.qZA())}function W(r,o){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Campo obrigat\xf3rio "),t.qZA())}function X(r,o){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Campo obrigat\xf3rio "),t.qZA())}function tt(r,o){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Campo obrigat\xf3rio 2 "),t.qZA())}function et(r,o){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Campo obrigat\xf3rio "),t.qZA())}function at(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"button",59),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.alterarUsuario())}),t._uU(1," Atualizar "),t.qZA()}}function rt(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"button",59),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.cadastrar())}),t._uU(1," Cadastrar "),t.qZA()}}const ot=function(){return[5,10,25,100]},m=function(r){return{"has-success":r}},it=function(){return{phone:!0}},lt=[{path:"",children:[{path:"",component:(()=>{class r{constructor(e,a){this.formBuilder=e,this.administradorService=a,this.validTextType=!1,this.validEmailType=!1,this.validNumberType=!1,this.validSourceType=!1,this.validDestinationType=!1,this.serchField="",this.matcher=new x.n,this.typeModal=null,this.idIsEditing=null,this.displayedColumns=["nome","login","email","whatsapp","timeStamp","actions"],this.usuarioFormControl=new n.NI("",[n.kI.required]),this.nomeCompletoFormControl=new n.NI("",[n.kI.required]),this.emailFormControl=new n.NI("",[n.kI.required,n.kI.email]),this.whatsappFormControl=new n.NI("",[n.kI.required,n.kI.minLength(13)]),this.carregarTabela()}textValidationType(e){this.validTextType=!!e}numberValidationType(e){this.validNumberType=!!e}emailValidationType(e){this.validEmailType=!!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}sourceValidationType(e){e?(this.validSourceType=!0,this.form.patchValue({confirmPassword:""})):this.validSourceType=!1}confirmDestinationValidationType(e){this.validDestinationType=!!e}displayFieldCss(e,a){return{"has-error":this.isFieldValid(e,a),"has-feedback":this.isFieldValid(e,a)}}isFieldValid(e,a){return!e.get(a).valid&&e.get(a).touched}openCadastrarModal(){this.typeModal="cadastrar",this.idIsEditing=null,this.limparModal(),$(".modal").modal("show")}openAlterarModal(e){this.typeModal="alterar",this.idIsEditing=e.id,this.form.patchValue({nomeCompleto:e.nome,login:e.login,whatsapp:e.whatsapp,email:e.email,password:"123456789101112",confirmPassword:"123456789101112"}),$(".modal").modal("show")}alterarUsuario(){this.cadastrarOrAtualizar("alterado")}cadastrar(){this.cadastrarOrAtualizar("cadastrado")}cadastrarOrAtualizar(e){var a=this.form.value;a.id=this.idIsEditing,this.form.markAllAsTouched(),this.form.valid&&this.administradorService.cadastrarOrAtualizarUsuario(a).toPromise().then(i=>{this.afterCreateOrUpdate("Tudo Certo!","Usu\xe1rio "+e+" com sucesso!")},i=>{u().fire({title:"Aten\xe7\xe3o!",text:i,icon:"warning",customClass:{confirmButton:"btn btn-danger"}})})}afterCreateOrUpdate(e,a){u().fire({title:e,text:a,buttonsStyling:!1,customClass:{confirmButton:"btn btn-success"},icon:"success"}),this.serchField="",this.limparModal(),$(".modal").modal("hide"),this.carregarTabela()}limparModal(){this.form.patchValue({nomeCompleto:"",login:"",whatsapp:"",email:"",password:"",confirmPassword:""})}excluirUsuario(e){console.log(e),u().fire({title:"Voc\xea tem certeza que quer excluir o usu\xe1rio "+e.login+" ?",text:"Essa a\xe7\xe3o n\xe3o poder\xe1 ser revertida.",icon:"warning",showCancelButton:!0,customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},confirmButtonText:"Sim",cancelButtonText:"N\xe3o",buttonsStyling:!1}).then(a=>{this.administradorService.excluirUsuario(e.id).subscribe(i=>{u().fire({title:"Excluido!",text:e.login+" foi excluido",icon:"success",customClass:{confirmButton:"btn btn-success"},buttonsStyling:!1}),this.carregarTabela()},i=>{u().fire({title:"Erro",text:i,icon:"warning",customClass:{confirmButton:"btn btn-danger"},buttonsStyling:!1})})})}applyFilter(e){e=(e=e.trim()).toLowerCase(),this.dataSource.filter=e}ngOnInit(){this.form=this.formBuilder.group({nomeCompleto:[null,n.kI.required],login:[null,n.kI.required],whatsapp:[null,n.kI.required],email:[null,[n.kI.required,n.kI.pattern("^[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,4}$")]],password:["",n.kI.required],confirmPassword:["",n.kI.required]},{validator:M.T.MatchPassword});var e=document.getElementsByClassName("main-panel")[0];$(".modal").on("shown.bs.modal",function(){e.classList.add("no-scroll")}),$(".modal").on("hidden.bs.modal",function(){e.classList.remove("no-scroll")})}ngAfterViewInit(){this.initPaginate()}initPaginate(){null!=this.dataSource&&(this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)}carregarTabela(){this.administradorService.getAllUsuariosByAmbiente().subscribe(e=>{const a=[];S.each(e,i=>{a.push(function st(r){return{id:r.id,nome:r.nome,login:r.login,email:r.email,whatsapp:r.whatsapp,timeStamp:r.timeStamp}}(i))}),this.dataSource=new d.by(a),this.initPaginate()})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(n.qu),t.Y36(q))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-administradores"]],viewQuery:function(e,a){if(1&e&&(t.Gf(A.NW,5),t.Gf(C.YE,5)),2&e){let i;t.iGM(i=t.CRH())&&(a.paginator=i.first),t.iGM(i=t.CRH())&&(a.sort=i.first)}},decls:92,vars:43,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header","card-header-primary","card-header-icon"],[1,"card-icon"],[1,"material-icons"],[1,"col-md-8"],[1,"card-title"],[1,"col-md-4"],["mat-raised-button","",1,"btn","btn-warning","btn-raised","float-right",3,"click"],[1,"card-body"],[1,"toolbar"],["matInput","","placeholder","Pesquisar",3,"ngModel","ngModelChange","keyup"],[1,"material-datatables"],[1,"example-header"],[1,"example-container","mat-elevation-z8"],["matSort","",3,"dataSource"],["matColumnDef","nome"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","login"],["matColumnDef","email"],["matColumnDef","whatsapp"],["matColumnDef","timeStamp"],["matColumnDef","actions",1,"float-right"],["class","float-right",4,"matHeaderCellDef"],["class","float-right",4,"matCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[3,"pageSizeOptions"],["id","myModal","tabindex","-1","role","dialog","aria-labelledby","myModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["mat-button","","type","button","data-dismiss","modal","aria-hidden","true",1,"close"],[1,"modal-body"],["action","","method","",1,"form",3,"formGroup"],[1,"example-full-width","has-label",3,"ngClass"],["type","text","placeholder","Nome Completo","matInput","","id","nomeCompleto","formControlName","nomeCompleto"],[4,"ngIf"],[1,"example-full-width",3,"ngClass"],["type","email","placeholder","E-mail","matInput","","formControlName","email",3,"errorStateMatcher","ngModelChange"],["type","text","name","whatsapp","placeholder","Whatsapp Business","matInput","","formControlName","whatsapp",3,"brmasker","ngModelChange"],["type","text","placeholder","Login","matInput","","id","login","formControlName","login",3,"ngModelChange"],[1,"col-md-6"],["type","password","placeholder","Senha","matInput","","name","idSource","formControlName","password",3,"ngModelChange"],["errorMsg","Campo obrigat\xf3rio",3,"displayError"],["type","password","placeholder","Repetir a senha","matInput","","name","idDestination","formControlName","confirmPassword",3,"ngModelChange"],["errorMsg","As senhas devem ser iguais",3,"displayError"],[1,"modal-footer"],["mat-raised-button","","type","button","data-dismiss","modal",1,"btn","btn-danger","btn-link",3,"click"],["mat-raised-button","","type","button","class","btn btn-success btn-link",3,"click",4,"ngIf"],["mat-sort-header",""],[1,"float-right"],["mat-raised-button","",1,"btn","btn-warning","btn-raised","btn-round","btn-fab","float-right",3,"click"],["mat-raised-button","",1,"btn","btn-danger","btn-raised","btn-round","btn-fab","float-right",3,"click"],["mat-raised-button","","type","button",1,"btn","btn-success","btn-link",3,"click"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"i",7),t._uU(8,"assignment"),t.qZA()(),t.TgZ(9,"div",2)(10,"div",8)(11,"h4",9),t._uU(12,"Gerenciar Administradores e Usu\xe1rios"),t.qZA()(),t.TgZ(13,"div",10)(14,"button",11),t.NdJ("click",function(){return a.openCadastrarModal()}),t._uU(15," Cadastrar usu\xe1rio "),t.qZA()()()(),t.TgZ(16,"div",12)(17,"div",13)(18,"mat-form-field")(19,"input",14),t.NdJ("ngModelChange",function(l){return a.serchField=l})("keyup",function(l){return a.applyFilter(l.target.value)}),t.qZA()()(),t.TgZ(20,"div",15),t._UZ(21,"div",16),t.TgZ(22,"div",17)(23,"mat-table",18),t.ynx(24,19),t.YNc(25,E,2,0,"mat-header-cell",20),t.YNc(26,k,2,1,"mat-cell",21),t.BQk(),t.ynx(27,22),t.YNc(28,Q,2,0,"mat-header-cell",20),t.YNc(29,B,2,1,"mat-cell",21),t.BQk(),t.ynx(30,23),t.YNc(31,D,2,0,"mat-header-cell",20),t.YNc(32,Y,2,1,"mat-cell",21),t.BQk(),t.ynx(33,24),t.YNc(34,V,2,0,"mat-header-cell",20),t.YNc(35,z,2,1,"mat-cell",21),t.BQk(),t.ynx(36,25),t.YNc(37,H,2,0,"mat-header-cell",20),t.YNc(38,O,3,4,"mat-cell",21),t.BQk(),t.ynx(39,26),t.YNc(40,G,2,0,"mat-header-cell",27),t.YNc(41,K,7,0,"mat-cell",28),t.BQk(),t.YNc(42,P,1,0,"mat-header-row",29),t.YNc(43,L,1,0,"mat-row",30),t.qZA(),t._UZ(44,"mat-paginator",31),t.qZA()()()()()()(),t.TgZ(45,"div",32)(46,"div",33)(47,"div",34)(48,"div",35)(49,"h4",36),t._uU(50,"Modal title"),t.qZA(),t.TgZ(51,"button",37)(52,"i",7),t._uU(53,"clear"),t.qZA()()(),t.TgZ(54,"div",38)(55,"form",39)(56,"div",2)(57,"div",3)(58,"mat-form-field",40),t._UZ(59,"input",41),t.YNc(60,j,2,0,"mat-error",42),t.qZA()()(),t.TgZ(61,"div",2)(62,"div",3)(63,"mat-form-field",43)(64,"input",44),t.NdJ("ngModelChange",function(l){return a.emailValidationType(l)}),t.qZA(),t.YNc(65,R,2,0,"mat-error",42),t.YNc(66,W,2,0,"mat-error",42),t.qZA()()(),t.TgZ(67,"div",2)(68,"div",3)(69,"mat-form-field",40)(70,"input",45),t.NdJ("ngModelChange",function(l){return a.numberValidationType(l)}),t.qZA(),t.YNc(71,X,2,0,"mat-error",42),t.YNc(72,tt,2,0,"mat-error",42),t.qZA()()(),t.TgZ(73,"div",2)(74,"div",3)(75,"mat-form-field",40)(76,"input",46),t.NdJ("ngModelChange",function(l){return a.textValidationType(l)}),t.qZA(),t.YNc(77,et,2,0,"mat-error",42),t.qZA()()(),t.TgZ(78,"div",2)(79,"div",47)(80,"mat-form-field",43)(81,"input",48),t.NdJ("ngModelChange",function(l){return a.sourceValidationType(l)}),t.qZA(),t._UZ(82,"app-field-error-display",49),t.qZA()(),t.TgZ(83,"div",47)(84,"mat-form-field",43)(85,"input",50),t.NdJ("ngModelChange",function(l){return a.confirmDestinationValidationType(l)}),t.qZA(),t._UZ(86,"app-field-error-display",51),t.qZA()()()()(),t.TgZ(87,"div",52)(88,"button",53),t.NdJ("click",function(){return a.limparModal()}),t._uU(89," Cancelar "),t.qZA(),t.YNc(90,at,2,0,"button",54),t.YNc(91,rt,2,0,"button",54),t.qZA()()()()()),2&e&&(t.xp6(19),t.Q6J("ngModel",a.serchField),t.xp6(4),t.Q6J("dataSource",a.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(29,ot)),t.xp6(11),t.Q6J("formGroup",a.form),t.xp6(3),t.Q6J("ngClass",t.VKq(30,m,!0===a.validTextType))("ngClass",a.displayFieldCss(a.form,"nomeCompleto")),t.xp6(2),t.Q6J("ngIf",a.nomeCompletoFormControl.hasError("required")),t.xp6(3),t.Q6J("ngClass",t.VKq(32,m,!0===a.validEmailType)),t.xp6(1),t.Q6J("errorStateMatcher",a.matcher),t.xp6(1),t.Q6J("ngIf",a.emailFormControl.hasError("email")&&!a.emailFormControl.hasError("required")),t.xp6(1),t.Q6J("ngIf",a.emailFormControl.hasError("required")),t.xp6(3),t.Q6J("ngClass",t.VKq(34,m,!0===a.validNumberType))("ngClass",a.displayFieldCss(a.form,"whatsapp")),t.xp6(1),t.Q6J("brmasker",t.DdM(36,it)),t.xp6(1),t.Q6J("ngIf",a.whatsappFormControl.hasError("required")),t.xp6(1),t.Q6J("ngIf",a.whatsappFormControl.hasError("minLength")),t.xp6(3),t.Q6J("ngClass",t.VKq(37,m,!0===a.validTextType))("ngClass",a.displayFieldCss(a.form,"login")),t.xp6(2),t.Q6J("ngIf",a.usuarioFormControl.hasError("required")),t.xp6(3),t.Q6J("ngClass",t.VKq(39,m,!0===a.validSourceType))("ngClass",a.displayFieldCss(a.form,"password")),t.xp6(2),t.Q6J("displayError",a.isFieldValid(a.form,"password")),t.xp6(2),t.Q6J("ngClass",t.VKq(41,m,!0===a.validDestinationType))("ngClass",a.displayFieldCss(a.form,"confirmPassword")),t.xp6(2),t.Q6J("displayError",a.isFieldValid(a.form,"confirmPassword")),t.xp6(4),t.Q6J("ngIf","alterar"==a.typeModal),t.xp6(1),t.Q6J("ngIf","cadastrar"==a.typeModal))},dependencies:[p.mk,p.O5,n._Y,n.Fj,n.JJ,n.JL,n.On,v.TO,v.KE,I.Nt,A.NW,J.lW,C.YE,C.nU,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,n.sg,n.u,y.y,b.bS,p.uU],encapsulation:2}),r})()}]}];let dt=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[p.ez,Z.Bz.forChild(lt),n.u5,w.W,N.q,n.UX,y.y,b.Tx]}),r})()}}]);